
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Maggot, Metadata aggregation on data storage">
      
      
        <meta name="author" content="Daniel Jacob">
      
      
      
        <link rel="prev" href="../infrastructure/">
      
      
        <link rel="next" href="../definitions/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Maggot - Installation - Maggot</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../css/extra.css">
    
      <link rel="stylesheet" href="../css/pdfextra.css">
    
      <link rel="stylesheet" href="../css/lightbox.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#installation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Maggot" class="md-header__button md-logo" aria-label="Maggot" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Maggot
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Maggot - Installation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Maggot" class="md-nav__button md-logo" aria-label="Maggot" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Maggot
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../tutorial/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Quick tutorial
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Quick tutorial
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/describe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Metadata Entry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Metadata File
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Search Datasets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../infrastructure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Infrastructure
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#install-on-your-linux-computer-or-linux-unix-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Install on your linux computer or linux / unix server
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Install on your linux computer or linux / unix server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#retrieving-the-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Retrieving the code
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installation-of-docker-containers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installation of Docker containers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        Commands
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#home-page-customization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Home page customization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#starting-the-application" class="md-nav__link">
    <span class="md-ellipsis">
      
        Starting the application
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#launching-the-web-application-in-the-web-browser" class="md-nav__link">
    <span class="md-ellipsis">
      
        Launching the web application in the web browser
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stoping-the-application" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stoping the application
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updating-the-application" class="md-nav__link">
    <span class="md-ellipsis">
      
        Updating the application
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture diagram
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-browser" class="md-nav__link">
    <span class="md-ellipsis">
      
        File Browser
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        Authentication
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../definitions/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Definition files
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Definition files
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../definitions/terminology/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Terminology
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../definitions/vocabulary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vocabulary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../definitions/mapping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mapping
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../definitions/dataverse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dataverse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../definitions/zenodo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Zenodo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../definitions/json-ld/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JSON-LD
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../definitions/oai-pmh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OAI-PMH
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dictionaries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dictionaries
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../publish/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Publication
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Publication
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../publish/dataverse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dataverse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../publish/zenodo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Zenodo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h1>
<style>.md-typeset h1 {display: none;} .md-nav__item {font-size: medium}</style>

<h3 id="install-on-your-linux-computer-or-linux-unix-server">Install on your linux computer or linux / unix server<a class="headerlink" href="#install-on-your-linux-computer-or-linux-unix-server" title="Permanent link">&para;</a></h3>
<p>Requirements: The installation must be carried out on a (virtual) machine with  a recent Linux OS that support <a href="https://www.docker.com/get-started/" target="_blank">Docker</a> (see <a href="../infrastructure">Infrastructure</a>)</p>
<p><br></p>
<h4 id="retrieving-the-code">Retrieving the code<a class="headerlink" href="#retrieving-the-code" title="Permanent link">&para;</a></h4>
<p>Go to the destination directory of your choice then clone the repository and <code>cd</code> to your clone path:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/inrae/pgd-mmdt.git<span class="w"> </span>pgd-mmdt
<span class="nb">cd</span><span class="w"> </span>pgd-mmdt
</code></pre></div>
<p><br></p>
<h4 id="installation-of-docker-containers">Installation of Docker containers<a class="headerlink" href="#installation-of-docker-containers" title="Permanent link">&para;</a></h4>
<p>MAGGOT uses 3 Docker images for 3 distinct services:</p>
<ul>
<li><strong>pgd-mmdt-db</strong> which hosts the <a href="https://www.mongodb.com/basics" target="_blank">MongoDB</a> database</li>
<li><strong>pgd-mmdt-scan</strong> which scans the data and updates the contents of the database and the web interface</li>
<li><strong>pgd-mmdt-web</strong> which hosts the web server and the web interface pages</li>
</ul>
<p><br></p>
<h4 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h4>
<ul>
<li><em><a href="https://github.com/inrae/pgd-mmdt/blob/main/run" target="_blank">run</a></em> : defines root of the data directory (including for development)</li>
<li><em><a href="https://github.com/inrae/pgd-mmdt/blob/main/docker/db/initialisation/setupdb-js.template" target="_blank">docker/db/initialisation/setupdb-js.template</a></em> : defines MongoDB settings</li>
<li><em><a href="https://github.com/inrae/pgd-mmdt/blob/main/docker/scan/scripts/config.py" target="_blank">docker/scan/scripts/config.py</a></em> : defines MongoDB settings (dbserver, dbport, username, password)</li>
<li><em><a href="https://github.com/inrae/pgd-mmdt/blob/main/web/inc/config/mongodb.inc" target="_blank">web/inc/config/mongodb.inc</a></em> : defines MongoDB settings (dbserver, dbport, username, password)</li>
<li><em><a href="https://github.com/inrae/pgd-mmdt/blob/main/web/inc/config/config.inc" target="_blank">web/inc/config/config.inc</a></em> : defines many of web parameters (modify only if necessary)</li>
<li><strong><em>web/inc/config/local.inc</em></strong> : defines the application parameters specific to the local installation (not erased when updating).</li>
</ul>
<p>See <a href="../settings">Configuration settings</a></p>
<p><strong><em>Warning</em></strong> : You have to pay attention to put the same MongoDB settings in all the above configuration files. It is best not to change anything. It would have been preferable to put a single configuration file but this was not yet done given the different languages involved (bash, javascript, python, PHP). To be done!</p>
<p><strong><em>Warning</em></strong> : If you are using VirtualBox with Windows then you must make sure to <a href="../avx_win11_vbox">Enable AVX</a></p>
<p><strong><em>Note</em></strong> : If you want to run multiple instances, you will need to change in the <em><a href="../settings/#run">run</a></em> file, <em>i)</em> the container names, <em>ii)</em> the data path, <em>iii)</em> the MongoDB volume name and <em>iv)</em> the MongoDB port</p>
<p>The following two JSON files are defined by default but can be easily configured from the web interface. See the <a href="../configuration">Terminology Configuration</a> section.</p>
<ul>
<li><strong><em>web/conf/config_terms.json</em></strong> : define the <a href="../definitions/terminology">terminology</a></li>
<li><strong><em>web/conf/maggot-schema.json</em></strong> : define the JSON schema used to validate metadata files.</li>
</ul>
<p><br></p>
<h4 id="commands">Commands<a class="headerlink" href="#commands" title="Permanent link">&para;</a></h4>
<p>The <strong><em>run</em></strong> shell script allows you to perform multiple actions by specifying an option :</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>pgd-mmdt
sh<span class="w"> </span>./run<span class="w"> </span>&lt;option&gt;
</code></pre></div>
<p><strong>Options</strong>:</p>
<ul>
<li><strong><em>build</em></strong> : Creates the 3 Docker images namely <strong><em>pgd-mmdt-db</em></strong>, <strong><em>pgd-mmdt-scan</em></strong> and <strong><em>pgd-mmdt-web</em></strong></li>
<li><strong><em>pull</em></strong> : Retrieves (pull) from DockerHub the 3 Docker images namely <strong><em>pgd-mmdt-db</em></strong>, <strong><em>pgd-mmdt-scan</em></strong> and <strong><em>pgd-mmdt-web</em></strong></li>
<li><strong><em>start</em></strong> : <em>1</em>) Starts the 3 services by creating the Docker containers corresponding to the Docker images; <em>2</em>) Creates also the MongoDB volume.</li>
<li><strong><em>stop</em></strong> :  <em>1</em>) Removes all the 3 Docker containers; <em>2</em>) Remove the MongoDB volume.</li>
<li><strong><em>initdb</em></strong> : Creates and initializes the Mongo collection then loads the metadata sets (JSON file) into the database</li>
<li><strong><em>scan</em></strong> : Scans the directory tree for metadata files and compiles them into a JSON file.</li>
<li><strong><em>fullstart</em></strong> : Executes the <strong><em>start</em></strong> and <strong><em>initdb</em></strong> actions.</li>
<li><strong><em>restart</em></strong> : Executes the <strong><em>stop</em></strong> and <strong><em>fullstart</em></strong> actions.</li>
<li><strong><em>ps</em></strong> : Checks that all containers are running correctly</li>
<li><strong><em>statdb</em></strong> : Retrieves information about the Mongo database in JSON format (Application must be started in full mode)</li>
<li><strong><em>showdb</em></strong> : Retrieves the content of the Mongo database in JSON format (Application must be started in full mode)</li>
<li><strong><em>passwd</em></strong> &lt;<em>user</em>&gt;: Defines the admin password if no <em>user</em> is specified, allowing you to add entries in dictionaries or to add/update the terminology files (<em>definition</em> &amp; <em>documentation</em>, see <a href="../configuration">configuration</a>). If a <em>user</em> is specified, the dictionary consultation will be authorized for this user.</li>
</ul>
<p><br></p>
<h4 id="home-page-customization">Home page customization<a class="headerlink" href="#home-page-customization" title="Permanent link">&para;</a></h4>
<ul>
<li>Since the <a href="https://github.com/inrae/pgd-mmdt/blob/main/CHANGES.md" target="_blank">version 2.3</a>, it is now more easy to customize the home page, depending on your site. See  <a href="../home_page">Home page customization </a></li>
</ul>
<p><br></p>
<h4 id="starting-the-application">Starting the application<a class="headerlink" href="#starting-the-application" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>You must first either build the 3 docker container images ... (using MongoDB 6.0+ with <a href="../avx_win11_vbox">AVX enabled</a>)
   <div class="highlight"><pre><span></span><code>sh<span class="w"> </span>./run<span class="w"> </span>build
</code></pre></div></p>
</li>
<li>
<p>... or pull the 3 images from DockerHub
   <div class="highlight"><pre><span></span><code>sh<span class="w"> </span>./run<span class="w"> </span>pull
</code></pre></div></p>
</li>
<li>
<p>The application can be sequentially started :</p>
<ul>
<li>Starting the web interface
 <div class="highlight"><pre><span></span><code>sh<span class="w"> </span>./run<span class="w"> </span>start
</code></pre></div></li>
<li>Scanning  the data directory to search for metadata files (<em>META_XXXX.json</em>) in case this is the first time the application is being run.
 <div class="highlight"><pre><span></span><code>sh<span class="w"> </span>./run<span class="w"> </span>scan
</code></pre></div></li>
<li>Initialization of the MongoDB database
 <div class="highlight"><pre><span></span><code>sh<span class="w"> </span>./run<span class="w"> </span>initdb
</code></pre></div></li>
</ul>
</li>
<li>
<p>You can also launch the 2 steps (<em>start</em> and <em>initdb</em>) with a single command:
   <div class="highlight"><pre><span></span><code>sh<span class="w"> </span>./run<span class="w"> </span>fullstart
</code></pre></div></p>
</li>
<li>You can check if all metadata sets have been loaded using the <em>showdb</em> action:
   <div class="highlight"><pre><span></span><code>sh<span class="w"> </span>./run<span class="w"> </span>showdb<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s1">&#39; title&#39;</span>
</code></pre></div></li>
<li>To update the MongoDB database in case you have uploaded a new or updated metadata file, you must perform a <em>scan</em> then <em>restart</em> the system once it is complete. This allows for a background scan without preventing the application from functioning.
     <div class="highlight"><pre><span></span><code>sh<span class="w"> </span>./run<span class="w"> </span>scan
sh<span class="w"> </span>./run<span class="w"> </span>restart
</code></pre></div></li>
<li><strong>WARNING</strong>: Modifying the terminology file will also affect MongoDB. Therefore, you must first <em>stop</em> and then restart the application without initializing the database, perform a <em>scan</em>, and then <em>restart</em> the application in full mode.
     <div class="highlight"><pre><span></span><code>sh<span class="w"> </span>./run<span class="w"> </span>stop
sh<span class="w"> </span>./run<span class="w"> </span>start
sh<span class="w"> </span>./run<span class="w"> </span>scan
sh<span class="w"> </span>./run<span class="w"> </span>restart
</code></pre></div></li>
</ul>
<p><br></p>
<h4 id="launching-the-web-application-in-the-web-browser">Launching the web application in the web browser<a class="headerlink" href="#launching-the-web-application-in-the-web-browser" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>Once the application is started, we can see if the containers are started using the following command:
   <div class="highlight"><pre><span></span><code>docker<span class="w"> </span>ps<span class="w"> </span>-a
</code></pre></div></p>
</li>
<li>
<p>which should produce a result similar to the following:</p>
</li>
</ul>
<pre style="color:#060606; font-size: 12px;">
   CONTAINER ID  IMAGE          COMMAND                 CREATED          STATUS         PORTS                                  NAMES
   5914504f456d  pgd-mmdt-web   "docker-php-entrypoi."  12 seconds ago   Up 10 seconds  0.0.0.0:8087->80/tcp, :::8087->80/tcp  mmdt-web
   226b13ed9467  pgd-mmdt-scan  "cron -f"               12 seconds ago   Up 11 seconds                                         mmdt-scan
   81fecbb56d23  pgd-mmdt-db    "docker-entrypoint.s."  13 seconds ago   Up 12 seconds  27017/tcp                              mmdt-db
</pre>

<ul>
<li>
<p>On the first line, the one which corresponds to the web interface, we see that port 80 of the docker is exported to port 8087 of the VM.
Let's say that the IP address of your VM is 192.168.56.2, then in your browser you will need to put the URL <a href="http://192.168.56.2:8087/">http://192.168.56.2:8087/</a>. You can of course change the port number in the '<em><a href="../settings/#run">run</a></em>' file.</p>
</li>
<li>
<p>Finally, we recommend using a lightweight http server like <a href="https://docs.nginx.com/nginx/admin-guide/web-server/web-server/" target="_blank">nginx</a> so that the Maggot URL will be <a href="http://192.168.56.2/maggot/">http://192.168.56.2/maggot/</a>. Below an example of config:
   <div class="highlight"><pre><span></span><code><span class="c1">## /etc/nginx/nginx.conf</span>
http<span class="w"> </span><span class="o">{</span>

...
<span class="w">    </span>upstream<span class="w"> </span>maggot<span class="w">  </span><span class="o">{</span><span class="w"> </span>server<span class="w"> </span><span class="m">127</span>.0.0.1:8087<span class="p">;</span><span class="w"> </span><span class="o">}</span>
...

<span class="o">}</span>

<span class="c1">## /etc/nginx/conf.d/my-site.conf</span>

server<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>listen<span class="w"> </span><span class="m">80</span><span class="w"> </span>default<span class="p">;</span>
<span class="w">    </span>server_name<span class="w"> </span><span class="nv">$host</span><span class="p">;</span>

...

<span class="w">    </span>location<span class="w"> </span>~<span class="w"> </span>^/maggot/api/<span class="o">([</span>^/<span class="o">]</span>+<span class="o">)</span>/<span class="o">([</span>^/<span class="o">]</span>+<span class="o">)</span>$<span class="w"> </span><span class="o">{</span>
<span class="w">        </span>rewrite<span class="w"> </span>^/maggot/api/<span class="o">([</span>^/<span class="o">]</span>+<span class="o">)</span>/<span class="o">([</span>^/<span class="o">]</span>+<span class="o">)</span>$<span class="w"> </span>/maggot/metadata/<span class="nv">$1</span>?format<span class="o">=</span><span class="nv">$2</span><span class="p">;</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span>location<span class="w"> </span>~<span class="w"> </span>^/maggot/api/<span class="o">([</span>^/<span class="o">]</span>+<span class="o">)</span>$<span class="w"> </span><span class="o">{</span>
<span class="w">        </span>rewrite<span class="w"> </span>^/maggot/api/<span class="o">([</span>^/<span class="o">]</span>+<span class="o">)</span>$<span class="w"> </span>/maggot/metadata/<span class="nv">$1</span>?format<span class="o">=</span>maggot<span class="p">;</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span>location<span class="w"> </span>~<span class="w"> </span>^/maggot/graph/<span class="o">([</span>^/<span class="o">]</span>+<span class="o">)</span>$<span class="w"> </span><span class="o">{</span>
<span class="w">         </span>rewrite<span class="w"> </span>^/maggot/graph/<span class="o">([</span>^/<span class="o">]</span>+<span class="o">)</span>$<span class="w"> </span>/maggot/metadata/<span class="nv">$1</span>?format<span class="o">=</span>graph<span class="p">;</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span>location<span class="w"> </span>/maggot/<span class="w"> </span><span class="o">{</span>
<span class="w">        </span>proxy_set_header<span class="w"> </span>Host<span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
<span class="w">        </span>proxy_set_header<span class="w"> </span>X-App-Name<span class="w"> </span><span class="s1">&#39;maggot&#39;</span><span class="p">;</span>
<span class="w">        </span>proxy_set_header<span class="w"> </span>X-Real-Ip<span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
<span class="w">        </span>proxy_set_header<span class="w"> </span>X-Forwarded-Host<span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
<span class="w">        </span>proxy_set_header<span class="w"> </span>X-Forwarded-For<span class="w"> </span><span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
<span class="w">        </span>proxy_pass<span class="w"> </span>http://maggot/<span class="p">;</span>
<span class="w">    </span><span class="o">}</span>

...

<span class="o">}</span>
</code></pre></div></p>
</li>
</ul>
<p><br></p>
<h4 id="stoping-the-application">Stoping the application<a class="headerlink" href="#stoping-the-application" title="Permanent link">&para;</a></h4>
<ul>
<li>To stop the application :
   <div class="highlight"><pre><span></span><code>sh<span class="w"> </span>./run<span class="w"> </span>stop
</code></pre></div></li>
</ul>
<p><br></p>
<h4 id="updating-the-application">Updating the application<a class="headerlink" href="#updating-the-application" title="Permanent link">&para;</a></h4>
<p>When updating the application, it is imperative to preserve a whole set of configuration files as well as the content of certain directories (dictionaries, javascripts dedicated to vocabularies, etc.). An update script is available (<a href="https://github.com/inrae/pgd-mmdt/blob/main/etc/update-maggot.sh" target="_blank">./etc/update-maggot.sh</a>) preferably placed under '<strong>/usr/local/bin</strong>'. To preserve your configuration, it is recommended to create local configuration files.</p>
<ul>
<li>
<p>A first file '<strong>local.conf</strong>' will contain all the parameters to be preserved, initially contained in the '<em><a href="../settings/#run">run</a></em>' file. A small example could be as follow :
   <div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># Hostname of the Website</span>
<span class="nv">HOST</span><span class="o">=</span>pmb-bordeaux.fr

<span class="c1"># Local HTTP Port for web application</span>
<span class="nv">WEB_PORT</span><span class="o">=</span><span class="m">8088</span>

<span class="c1"># Path to the data</span>
<span class="nv">DATADIR</span><span class="o">=</span>/media/Workdir/Share/DATA/
</code></pre></div></p>
</li>
<li>
<p>A second file '<strong>./web/inc/config/local.inc</strong>' will contain all the parameters to be preserved, initially contained in the '<em><a href="../settings/#incconfigconfiginc">./web/inc/config/config.inc</a></em>' file. A small example could be as follow :
   <div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="c1"># Main title</span>
<span class="nv">$TITLE</span> <span class="o">=</span><span class="s1">&#39;Metadata management - My Labs&#39;</span><span class="p">;</span>
<span class="nv">$MAINTITLE</span> <span class="o">=</span><span class="nv">$TITLE</span><span class="p">;</span>

<span class="c1"># File Browser</span>
<span class="nv">$FILEBROWSER</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="nv">$URL_FILEBROWSER</span><span class="o">=</span><span class="s1">&#39;/fb/&#39;</span><span class="p">;</span>

<span class="c1"># Enable some functionalities</span>
<span class="nv">$export_oai</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="cp">?&gt;</span>
</code></pre></div></p>
</li>
</ul>
<hr />
<h3 id="architecture-diagram">Architecture diagram<a class="headerlink" href="#architecture-diagram" title="Permanent link">&para;</a></h3>
<p>The architecture diagram shows the modules and their interactions (MongoDB, Web Interface, Metadata File Search), each embedded in a Docker container.</p>
<p><em>See how to do proceed for <a href="../configuration">configuration steps</a>.</em></p>
<center>
<a href="../images/schema.png" data-lightbox="fig0"><img src="../images/schema.png" width="800px"></a>
</center>

<p><br></p>
<hr />
<h3 id="file-browser">File Browser<a class="headerlink" href="#file-browser" title="Permanent link">&para;</a></h3>
<p>You can provide access to your data via a <a href="https://filebrowser.org/" target="_blank">file browser</a>. This application must be <a href="https://github.com/djacob65/maggot-fb" target="_blank">installed separately</a> but can be connected to Maggot by specifying the corresponding URL in the <a href="../settings/#incconfigconfiginc">configuration file</a>. Users and their rights are managed in the filebrowser application. Likewise, we can also <a href="../images/filebrowser_fig2.png" data-lightbox="fig2">create links to the data without a password</a>. These links can be usefully specified as external resources in the metadata managed by Maggot.</p>
<p><em>See how to do install in <a href="https://github.com/djacob65/maggot-fb" target="_blank">github</a></em></p>
<center>
<a href="../images/filebrowser_fig1.png" data-lightbox="fig10"><img src="../images/filebrowser_fig1.png" width="800px"></a>
</center>

<p><br></p>
<hr />
<h3 id="authentication">Authentication<a class="headerlink" href="#authentication" title="Permanent link">&para;</a></h3>
<p><strong>Purpose</strong>: Implement an authentication layer based on <a href="https://en.wikipedia.org/wiki/OAuth" target="_blank">OAUTH 2.0</a></p>
<p>The initial choice was not to manage users in the Maggot tool. This choice was made to promote the complete opening by default of metadata within a collective. However, for management within a collective that goes beyond a simple intranet, it is necessary to set up an authentication layer. Setting up such a layer can be done independently of the Maggot tool, i.e. without modifying its code or configuration. An <a href="https://en.wikipedia.org/wiki/Single_sign-on" target="_blank">SSO</a> implementation is proposed online, which can serve as a basis for a larger configuration. A <a href="https://github.com/djacob65/maggot-sso/wiki/Single-Sign-On" target="_blank">Wiki page</a> provides a detailed description.</p>
<ul>
<li>Source code on github : <a href="https://github.com/djacob65/maggot-sso/" target="_blank">https://github.com/djacob65/maggot-sso/</a></li>
</ul>
<center>
<a href="../images/sso_oauth2.png" data-lightbox="fig11"><img src="../images/sso_oauth2.png" width="800px"></a>
<p style="text-align:center;"><i>Keycloak supports OIDC (an extension to OAuth 2.0) and works as an IdP while authenticating a client</i></p>
</center>

<p><br>
<br></p>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      INRAE, 2022-2024
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["toc.integrate", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "stable"}}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../js/jquery-2.1.1.min.js"></script>
      
        <script src="../js/lightbox.min.js"></script>
      
        <script src="../js/mermaid.min.js"></script>
      
        <script src="../js/extra.js"></script>
      
    
  </body>
</html>